---
title: "Dplyr and Tidyr lab"
format: html
editor: visual
author : CÃ©dric BAZILE
execute: 
  keep-md: true
  echo: FALSE
---

```{r}
#Setup

here::i_am("Dplyr-Lab---Friday-Group.Rproj")
library(here)
library(ggplot2)
library(dplyr)
library(tidyr)
Spt <- readRDS("~/Dauphine/M1 Quantitative Economics/Data Management/Dplyr-Lab---Friday-Group/top-spotify-songs-from-20102019-by-year.Rds")
```

<center>

# Dplyr-Lab (Friday-Group)

</center>

## Exercise 1

### Question 1 : A global perspective on the music scene during the last decade

```{r Variable name}
Var_name <- names(Spt)
Var_name


```

```{r}
d_song <- Spt %>% distinct(title,.keep_all = TRUE) %>% nrow()
d_art <- Spt %>% distinct(artist, .keep_all = TRUE) %>% nrow()
d_genre <- Spt %>% distinct(`top genre`, .keep_all = TRUE) %>% nrow()


```

```{r}
#I create some labels to be sure to recognize my data if I forget what it is

library("labelled")
var_label(d_art) <- "Artists (distinct data)"
var_label(d_song) <- "Chansons (distinct data)"
var_label(d_genre) <- "Genre (distinct data)"

```

During the decade, `r d_song` has been produced by `r d_art` artists. `r d_genre` different musical genre inhabit the nightclubs, house and playlists.

### Question 2 : Number of songs per year

```{r}
s_by_y <- Spt %>% distinct(artist,title, .keep_all = TRUE) %>% group_by(year)  %>% summarise("Number of songs" = n())
var_label(s_by_y) <- "Song by year"
s_by_y <- s_by_y %>% 
  rename("Release year" = year)
knitr::kable(s_by_y, caption ="Volume of production", format= "markdown")
```

### Question 3 : Most prolific artist

```{r}
Top_artist <-Spt %>% group_by(artist)%>% summarise("nsongs" = n()) %>% arrange(desc(nsongs))

top_artist_one <- head(Top_artist, 1)

Top_artist_name <- top_artist_one$artist

Top_artist_ns<- top_artist_one$nsongs

Mysentence <- paste("The  artist producing more songs was", Top_artist_name, "with ", Top_artist_ns, "songs")
cat(Mysentence)
```

### Question 4 : BPM

```{r}
BPM_stats <- Spt %>% distinct(title, .keep_all = TRUE) %>% group_by(`top genre`)%>% 
  summarize("Number of songs"=n(),"Min"=min(bpm), "Mediane"=median(bpm), "Moyenne"=mean(bpm), "Max"=max(bpm), "Sd in percentage"=(sd(bpm)/mean(bpm)))
knitr::kable(BPM_stats, caption ="Statistics on the BPM", format= "markdown")
```

### Question 5 :

### Question 6 :

## Exercise 2

### Question 1 :

### Question 2 :

### Question 3 :

### Question 4 :
